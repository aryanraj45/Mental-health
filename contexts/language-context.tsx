"use client"

import React, { createContext, useContext, useState, useEffect } from 'react'

// Define supported languages
export const languages = [
  { code: 'en', name: 'English', flag: 'ЁЯЗ║ЁЯЗ╕' },
  { code: 'hi', name: 'рд╣рд┐рдВрджреА', flag: 'ЁЯЗоЁЯЗ│' },
  { code: 'bn', name: 'ржмрж╛ржВрж▓рж╛', flag: 'ЁЯЗзЁЯЗй' },
  { code: 'ta', name: 'родрооро┐ро┤рпН', flag: 'ЁЯЗоЁЯЗ│' },
  { code: 'te', name: 'р░др▒Жр░▓р▒Бр░Чр▒Б', flag: 'ЁЯЗоЁЯЗ│' },
  { code: 'mr', name: 'рдорд░рд╛рдареА', flag: 'ЁЯЗоЁЯЗ│' },
  { code: 'gu', name: 'ркЧрлБркЬрк░рк╛ркдрлА', flag: 'ЁЯЗоЁЯЗ│' },
  { code: 'kn', name: 'р▓Хр▓ир│Нр▓ир▓б', flag: 'ЁЯЗоЁЯЗ│' },
  { code: 'ml', name: 'р┤ор┤▓р┤пр┤╛р┤│р┤В', flag: 'ЁЯЗоЁЯЗ│' },
  { code: 'pa', name: 'рикрй░риЬри╛римрйА', flag: 'ЁЯЗоЁЯЗ│' },
]

// Translation dictionary
export const translations = {
  en: {
    // Header
    'mental-wellness-platform': 'Mental Wellness Platform',
    'ai-support': 'AI Support',
    'resources': 'Resources',
    'community': 'Community',
    'book-session': 'Book Session',
    'emergency': 'Emergency',
    'dashboard': 'Dashboard',
    'login': 'Login',
    'logout': 'Logout',
    'signup': 'Sign Up',
    
    // Common
    'loading': 'Loading...',
    'save': 'Save',
    'cancel': 'Cancel',
    'continue': 'Continue',
    'back': 'Back',
    'next': 'Next',
    'submit': 'Submit',
    'close': 'Close',
    
    // Booking Page
    'book-counseling-session': 'Book a Counseling Session',
    'connect-with-professionals': 'Connect with certified mental health professionals for personalized support',
    'choose-date-time': 'Choose Date & Time',
    'select-counselor': 'Select Counselor',
    'session-details': 'Session Details',
    'confirmation': 'Confirmation',
    'select-preferred-date': 'Select your preferred date and time slot',
    'choose-counselor-matches': 'Choose a counselor that matches your needs',
    'provide-session-details': 'Provide session details and preferences',
    'review-confirm-booking': 'Review and confirm your booking',
    'select-date': 'Select Date',
    'select-time': 'Select Time',
    'next-choose-counselor': 'Next: Choose Counselor',
    'next-session-details': 'Next: Session Details',
    'review-booking': 'Review Booking',
    'confirm-booking': 'Confirm Booking',
    'session-type': 'Session Type',
    'video-call': 'Video Call',
    'voice-call': 'Voice Call',
    'in-person': 'In-Person',
    'book-anonymously': 'Book anonymously (counselor won\'t see your name until the session)',
    'what-discuss': 'What would you like to discuss? (Optional)',
    'share-concerns': 'Share what\'s on your mind or any specific concerns you\'d like to address...',
    'helps-counselor-prepare': 'This helps your counselor prepare for the session',
    'urgent-support': 'This is urgent - I need support as soon as possible',
    'booking-summary': 'Booking Summary',
    'date': 'Date',
    'time': 'Time',
    'counselor': 'Counselor',
    'duration': 'Duration',
    'total-cost': 'Total Cost',
    'whats-next': 'What\'s Next:',
    'confirmation-email': 'You\'ll receive a confirmation email with session details',
    'reminder-24h': 'A reminder will be sent 24 hours before your appointment',
    'video-meeting-link': 'For video calls, you\'ll receive a secure meeting link',
    'reschedule-cancel': 'You can reschedule or cancel up to 4 hours before the session',
    
    // Emergency
    'crisis-support': 'Crisis Support',
    'immediate-help': 'Immediate Help Available 24/7',
    'emergency-contacts': 'Emergency Contacts',
    'ngos-organizations': 'NGOs & Organizations',
    'call-now': 'Call Now',
    'chat-whatsapp': 'Chat on WhatsApp',
    'visit-website': 'Visit Website',
    'location': 'Location',
    'available': 'Available',
    'filter-by-location': 'Filter by Location',
    'all-locations': 'All Locations',
    
    // Dashboard
    'welcome-back': 'Welcome back',
    'your-mental-wellness': 'Your Mental Wellness Journey',
    'mood-tracker': 'Mood Tracker',
    'upcoming-sessions': 'Upcoming Sessions',
    'recent-activities': 'Recent Activities',
    'wellness-badges': 'Wellness Badges',
    
    // Admin
    'admin-dashboard': 'Admin Dashboard',
    'student-analytics': 'Student Analytics & Crisis Management',
    'crisis-alerts': 'Crisis Alerts',
    'reports': 'Reports',
    'ai-insights': 'AI Insights',
    'student-search': 'Search students...',
    'search': 'Search',
    'export-data': 'Export Data',
    'download-report': 'Download Monthly Report',
    'new-crisis-alerts': 'New Crisis Alerts',
    'requiring-attention': 'requiring immediate attention',
    'mental-health-trends': 'Mental Health Trends',
    'average-score': 'Average Mental Health Score',
    
    // Community
    'peer-support': 'Peer Support Community',
    'connect-share-support': 'Connect, Share, and Support Each Other',
    'create-post': 'Create Post',
    'anonymous-post': 'Post Anonymously',
    'share-thoughts': 'Share your thoughts, experiences, or ask for support...',
    'post': 'Post',
    'reply': 'Reply',
    'helpful': 'Helpful',
    'support': 'Support',
    
    // Resources
    'mental-health-resources': 'Mental Health Resources',
    'tools-support-journey': 'Tools and content to support your mental wellness journey',
    'articles-guides': 'Articles & Guides',
    'video-content': 'Video Content',
    'audio-resources': 'Audio Resources',
    'interactive-tools': 'Interactive Tools',
    'read-more': 'Read More',
    'watch-now': 'Watch Now',
    'listen-now': 'Listen Now',
    'try-now': 'Try Now',
    
    // Wellness
    'wellness-center': 'Wellness Center',
    'personalized-activities': 'Personalized activities for your mental health',
    'breathing-exercises': 'Breathing Exercises',
    'meditation': 'Meditation',
    'journaling': 'Journaling',
    'mood-check': 'Mood Check-in',
    'start-exercise': 'Start Exercise',
    'begin-meditation': 'Begin Meditation',
    'start-journaling': 'Start Journaling',
    'check-mood': 'Check Your Mood',
  },
  
  hi: {
    // Header
    'mental-wellness-platform': 'рдорд╛рдирд╕рд┐рдХ рдХрд▓реНрдпрд╛рдг рдордВрдЪ',
    'ai-support': 'AI рд╕рд╣рд╛рдпрддрд╛',
    'resources': 'рд╕рдВрд╕рд╛рдзрди',
    'community': 'рд╕рдореБрджрд╛рдп',
    'book-session': 'рд╕рддреНрд░ рдмреБрдХ рдХрд░реЗрдВ',
    'emergency': 'рдЖрдкрд╛рддрдХрд╛рд▓',
    'dashboard': 'рдбреИрд╢рдмреЛрд░реНрдб',
    'login': 'рд▓реЙрдЧ рдЗрди',
    'logout': 'рд▓реЙрдЧрдЖрдЙрдЯ',
    'signup': 'рд╕рд╛рдЗрди рдЕрдк',
    
    // Common
    'loading': 'рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...',
    'save': 'рд╕рд╣реЗрдЬреЗрдВ',
    'cancel': 'рд░рджреНрдж рдХрд░реЗрдВ',
    'continue': 'рдЬрд╛рд░реА рд░рдЦреЗрдВ',
    'back': 'рд╡рд╛рдкрд╕',
    'next': 'рдЕрдЧрд▓рд╛',
    'submit': 'рдЬрдорд╛ рдХрд░реЗрдВ',
    'close': 'рдмрдВрдж рдХрд░реЗрдВ',
    
    // Booking Page
    'book-counseling-session': 'рдкрд░рд╛рдорд░реНрд╢ рд╕рддреНрд░ рдмреБрдХ рдХрд░реЗрдВ',
    'connect-with-professionals': 'рд╡реНрдпрдХреНрддрд┐рдЧрдд рд╕рд╣рд╛рдпрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрд┐рдд рдорд╛рдирд╕рд┐рдХ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдкреЗрд╢реЗрд╡рд░реЛрдВ рд╕реЗ рдЬреБрдбрд╝реЗрдВ',
    'choose-date-time': 'рджрд┐рдирд╛рдВрдХ рдФрд░ рд╕рдордп рдЪреБрдиреЗрдВ',
    'select-counselor': 'рдкрд░рд╛рдорд░реНрд╢рджрд╛рддрд╛ рдЪреБрдиреЗрдВ',
    'session-details': 'рд╕рддреНрд░ рд╡рд┐рд╡рд░рдг',
    'confirmation': 'рдкреБрд╖реНрдЯрд┐',
    'select-preferred-date': 'рдЕрдкрдиреА рдкрд╕рдВрджреАрджрд╛ рддрд╛рд░реАрдЦ рдФрд░ рд╕рдордп рд╕реНрд▓реЙрдЯ рдЪреБрдиреЗрдВ',
    'choose-counselor-matches': 'рдПрдХ рдкрд░рд╛рдорд░реНрд╢рджрд╛рддрд╛ рдЪреБрдиреЗрдВ рдЬреЛ рдЖрдкрдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реЛ',
    'provide-session-details': 'рд╕рддреНрд░ рд╡рд┐рд╡рд░рдг рдФрд░ рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░реЗрдВ',
    'review-confirm-booking': 'рдЕрдкрдиреА рдмреБрдХрд┐рдВрдЧ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдФрд░ рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ',
    'select-date': 'рджрд┐рдирд╛рдВрдХ рдЪреБрдиреЗрдВ',
    'select-time': 'рд╕рдордп рдЪреБрдиреЗрдВ',
    'next-choose-counselor': 'рдЕрдЧрд▓рд╛: рдкрд░рд╛рдорд░реНрд╢рджрд╛рддрд╛ рдЪреБрдиреЗрдВ',
    'next-session-details': 'рдЕрдЧрд▓рд╛: рд╕рддреНрд░ рд╡рд┐рд╡рд░рдг',
    'review-booking': 'рдмреБрдХрд┐рдВрдЧ рд╕рдореАрдХреНрд╖рд╛',
    'confirm-booking': 'рдмреБрдХрд┐рдВрдЧ рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ',
    'session-type': 'рд╕рддреНрд░ рдкреНрд░рдХрд╛рд░',
    'video-call': 'рд╡реАрдбрд┐рдпреЛ рдХреЙрд▓',
    'voice-call': 'рд╡реЙрдпрд╕ рдХреЙрд▓',
    'in-person': 'рд╡реНрдпрдХреНрддрд┐рдЧрдд',
    'book-anonymously': 'рдЧреБрдордирд╛рдо рд░реВрдк рд╕реЗ рдмреБрдХ рдХрд░реЗрдВ (рдкрд░рд╛рдорд░реНрд╢рджрд╛рддрд╛ рд╕рддреНрд░ рддрдХ рдЖрдкрдХрд╛ рдирд╛рдо рдирд╣реАрдВ рджреЗрдЦреЗрдЧрд╛)',
    'what-discuss': 'рдЖрдк рдХреНрдпрд╛ рдЪрд░реНрдЪрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ? (рд╡реИрдХрд▓реНрдкрд┐рдХ)',
    'share-concerns': 'рдЕрдкрдиреЗ рдорди рдХреА рдмрд╛рдд рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдпрд╛ рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЪрд┐рдВрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛рдПрдВ...',
    'helps-counselor-prepare': 'рдЗрд╕рд╕реЗ рдЖрдкрдХреЗ рдкрд░рд╛рдорд░реНрд╢рджрд╛рддрд╛ рдХреЛ рд╕рддреНрд░ рдХреА рддреИрдпрд╛рд░реА рдореЗрдВ рдорджрдж рдорд┐рд▓рддреА рд╣реИ',
    'urgent-support': 'рдпрд╣ рдЬрд░реВрд░реА рд╣реИ - рдореБрдЭреЗ рдЬрд▓реНрдж рд╕реЗ рдЬрд▓реНрдж рд╕рд╣рд╛рдпрддрд╛ рдЪрд╛рд╣рд┐рдП',
    'booking-summary': 'рдмреБрдХрд┐рдВрдЧ рд╕рд╛рд░рд╛рдВрд╢',
    'date': 'рджрд┐рдирд╛рдВрдХ',
    'time': 'рд╕рдордп',
    'counselor': 'рдкрд░рд╛рдорд░реНрд╢рджрд╛рддрд╛',
    'duration': 'рдЕрд╡рдзрд┐',
    'total-cost': 'рдХреБрд▓ рд▓рд╛рдЧрдд',
    'whats-next': 'рдЖрдЧреЗ рдХреНрдпрд╛:',
    'confirmation-email': 'рдЖрдкрдХреЛ рд╕рддреНрд░ рд╡рд┐рд╡рд░рдг рдХреЗ рд╕рд╛рде рдПрдХ рдкреБрд╖реНрдЯрд┐рдХрд░рдг рдИрдореЗрд▓ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛',
    'reminder-24h': 'рдЖрдкрдХреА рдирд┐рдпреБрдХреНрддрд┐ рд╕реЗ 24 рдШрдВрдЯреЗ рдкрд╣рд▓реЗ рдПрдХ рд░рд┐рдорд╛рдЗрдВрдбрд░ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛',
    'video-meeting-link': 'рд╡реАрдбрд┐рдпреЛ рдХреЙрд▓ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдореАрдЯрд┐рдВрдЧ рд▓рд┐рдВрдХ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛',
    'reschedule-cancel': 'рдЖрдк рд╕рддреНрд░ рд╕реЗ 4 рдШрдВрдЯреЗ рдкрд╣рд▓реЗ рддрдХ рдкреБрдирд░реНрдирд┐рд░реНрдзрд╛рд░рдг рдпрд╛ рд░рджреНрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ',
    
    // Emergency
    'crisis-support': 'рд╕рдВрдХрдЯ рд╕рд╣рд╛рдпрддрд╛',
    'immediate-help': 'рддрддреНрдХрд╛рд▓ рд╕рд╣рд╛рдпрддрд╛ 24/7 рдЙрдкрд▓рдмреНрдз',
    'emergency-contacts': 'рдЖрдкрд╛рддрдХрд╛рд▓реАрди рд╕рдВрдкрд░реНрдХ',
    'ngos-organizations': 'рдПрдирдЬреАрдУ рдФрд░ рд╕рдВрдЧрдарди',
    'call-now': 'рдЕрднреА рдХреЙрд▓ рдХрд░реЗрдВ',
    'chat-whatsapp': 'рд╡реНрд╣рд╛рдЯреНрд╕рдРрдк рдкрд░ рдЪреИрдЯ рдХрд░реЗрдВ',
    'visit-website': 'рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдЬрд╛рдПрдВ',
    'location': 'рд╕реНрдерд╛рди',
    'available': 'рдЙрдкрд▓рдмреНрдз',
    'filter-by-location': 'рд╕реНрдерд╛рди рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдлрд┐рд▓реНрдЯрд░ рдХрд░реЗрдВ',
    'all-locations': 'рд╕рднреА рд╕реНрдерд╛рди',
    
    // Dashboard
    'welcome-back': 'рд╡рд╛рдкрд╕ рд╕реНрд╡рд╛рдЧрдд рд╣реИ',
    'your-mental-wellness': 'рдЖрдкрдХреА рдорд╛рдирд╕рд┐рдХ рдХрд▓реНрдпрд╛рдг рдпрд╛рддреНрд░рд╛',
    'mood-tracker': 'рдореВрдб рдЯреНрд░реИрдХрд░',
    'upcoming-sessions': 'рдЖрдЧрд╛рдореА рд╕рддреНрд░',
    'recent-activities': 'рд╣рд╛рд▓ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпрд╛рдВ',
    'wellness-badges': 'рдХрд▓реНрдпрд╛рдг рдмреИрдЬ',
    
    // Admin
    'admin-dashboard': 'рдПрдбрдорд┐рди рдбреИрд╢рдмреЛрд░реНрдб',
    'student-analytics': 'рдЫрд╛рддреНрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рд╕рдВрдХрдЯ рдкреНрд░рдмрдВрдзрди',
    'crisis-alerts': 'рд╕рдВрдХрдЯ рдЕрд▓рд░реНрдЯ',
    'reports': 'рд░рд┐рдкреЛрд░реНрдЯ',
    'ai-insights': 'AI рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐',
    'student-search': 'рдЫрд╛рддреНрд░реЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ...',
    'search': 'рдЦреЛрдЬреЗрдВ',
    'export-data': 'рдбреЗрдЯрд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ',
    'download-report': 'рдорд╛рд╕рд┐рдХ рд░рд┐рдкреЛрд░реНрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ',
    'new-crisis-alerts': 'рдирдП рд╕рдВрдХрдЯ рдЕрд▓рд░реНрдЯ',
    'requiring-attention': 'рддрддреНрдХрд╛рд▓ рдзреНрдпрд╛рди рджреЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛',
    'mental-health-trends': 'рдорд╛рдирд╕рд┐рдХ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд░реБрдЭрд╛рди',
    'average-score': 'рдФрд╕рдд рдорд╛рдирд╕рд┐рдХ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реНрдХреЛрд░',
    
    // Community
    'peer-support': 'рд╕рд╛рдереА рд╕рд╣рд╛рдпрддрд╛ рд╕рдореБрджрд╛рдп',
    'connect-share-support': 'рдЬреБрдбрд╝реЗрдВ, рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рдФрд░ рдПрдХ-рджреВрд╕рд░реЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ',
    'create-post': 'рдкреЛрд╕реНрдЯ рдмрдирд╛рдПрдВ',
    'anonymous-post': 'рдЧреБрдордирд╛рдо рдкреЛрд╕реНрдЯ',
    'share-thoughts': 'рдЕрдкрдиреЗ рд╡рд┐рдЪрд╛рд░, рдЕрдиреБрднрд╡ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдпрд╛ рд╕рд╣рд╛рдпрддрд╛ рдорд╛рдВрдЧреЗрдВ...',
    'post': 'рдкреЛрд╕реНрдЯ',
    'reply': 'рдЙрддреНрддрд░',
    'helpful': 'рдЙрдкрдпреЛрдЧреА',
    'support': 'рд╕рд╣рд╛рдпрддрд╛',
    
    // Resources
    'mental-health-resources': 'рдорд╛рдирд╕рд┐рдХ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕рдВрд╕рд╛рдзрди',
    'tools-support-journey': 'рдЖрдкрдХреА рдорд╛рдирд╕рд┐рдХ рдХрд▓реНрдпрд╛рдг рдпрд╛рддреНрд░рд╛ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдХрд░рдг рдФрд░ рд╕рд╛рдордЧреНрд░реА',
    'articles-guides': 'рд▓реЗрдЦ рдФрд░ рдЧрд╛рдЗрдб',
    'video-content': 'рд╡реАрдбрд┐рдпреЛ рд╕рд╛рдордЧреНрд░реА',
    'audio-resources': 'рдСрдбрд┐рдпреЛ рд╕рдВрд╕рд╛рдзрди',
    'interactive-tools': 'рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдЯреВрд▓реНрд╕',
    'read-more': 'рдФрд░ рдкрдврд╝реЗрдВ',
    'watch-now': 'рдЕрднреА рджреЗрдЦреЗрдВ',
    'listen-now': 'рдЕрднреА рд╕реБрдиреЗрдВ',
    'try-now': 'рдЕрднреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ',
    
    // Wellness
    'wellness-center': 'рдХрд▓реНрдпрд╛рдг рдХреЗрдВрджреНрд░',
    'personalized-activities': 'рдЖрдкрдХреЗ рдорд╛рдирд╕рд┐рдХ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдХреЗ рд▓рд┐рдП рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЧрддрд┐рд╡рд┐рдзрд┐рдпрд╛рдВ',
    'breathing-exercises': 'рд╢реНрд╡рд╛рд╕ рдЕрднреНрдпрд╛рд╕',
    'meditation': 'рдзреНрдпрд╛рди',
    'journaling': 'рдкрддреНрд░рд┐рдХрд╛ рд▓реЗрдЦрди',
    'mood-check': 'рдореВрдб рдЪреЗрдХ-рдЗрди',
    'start-exercise': 'рдЕрднреНрдпрд╛рд╕ рд╢реБрд░реВ рдХрд░реЗрдВ',
    'begin-meditation': 'рдзреНрдпрд╛рди рд╢реБрд░реВ рдХрд░реЗрдВ',
    'start-journaling': 'рдкрддреНрд░рд┐рдХрд╛ рд▓реЗрдЦрди рд╢реБрд░реВ рдХрд░реЗрдВ',
    'check-mood': 'рдЕрдкрдирд╛ рдореВрдб рдЬрд╛рдВрдЪреЗрдВ',
  }
}

type Language = keyof typeof translations
type TranslationKey = keyof typeof translations.en

interface LanguageContextType {
  currentLanguage: Language
  setLanguage: (language: Language) => void
  t: (key: TranslationKey) => string
  availableLanguages: typeof languages
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined)

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [currentLanguage, setCurrentLanguage] = useState<Language>('en')

  useEffect(() => {
    // Load saved language from localStorage
    if (typeof window !== 'undefined') {
      const savedLanguage = localStorage.getItem('preferred-language') as Language
      if (savedLanguage && translations[savedLanguage]) {
        setCurrentLanguage(savedLanguage)
      }
    }
  }, [])

  const setLanguage = (language: Language) => {
    setCurrentLanguage(language)
    if (typeof window !== 'undefined') {
      localStorage.setItem('preferred-language', language)
    }
  }

  const t = (key: TranslationKey): string => {
    const languageTranslations = translations[currentLanguage]
    const fallbackTranslations = translations.en
    
    if (languageTranslations && key in languageTranslations) {
      return languageTranslations[key]
    }
    
    if (key in fallbackTranslations) {
      return fallbackTranslations[key]
    }
    
    return key
  }

  return (
    <LanguageContext.Provider value={{
      currentLanguage,
      setLanguage,
      t,
      availableLanguages: languages
    }}>
      {children}
    </LanguageContext.Provider>
  )
}

export function useLanguage() {
  const context = useContext(LanguageContext)
  if (context === undefined) {
    throw new Error('useLanguage must be used within a LanguageProvider')
  }
  return context
}
